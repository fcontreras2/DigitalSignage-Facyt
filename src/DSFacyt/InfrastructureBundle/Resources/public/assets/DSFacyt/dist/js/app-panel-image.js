var image=angular.module("ImageModule",["angular-repeat-n","mgcrea.ngStrap"]).config(function($interpolateProvider){$interpolateProvider.startSymbol("{[{").endSymbol("}]}")}).config(["$httpProvider",function($httpProvider){$httpProvider.defaults.withCredentials="",$httpProvider.defaults.useXDomain=!1,$httpProvider.defaults.headers.common["X-Requested-With"]="XMLHttpRequest"}]).config(function($datepickerProvider){angular.extend($datepickerProvider.defaults,{dateFormat:"dd/MM/yyyy",startWeek:1})});image.filter("range",function(){return function(input,init,total){total=parseInt(total);for(var i=init;total>=i;i++)input.push(i);return input}}),image.service("imageService",function(){this.checkStatus=function(data){$.each(data,function(index,value){switch(value.status){case 0:value.classStatus="fa fa-circle";break;case 1:value.classStatus="fa fa-circle-o";break;case 2:value.classStatus="fa fa-circle-thin"}})}}),image.controller("ImageController",["$scope","$filter","imageService","$modal","$alert",function($scope,$filter,imageService,$modal,$alert){function checkEmptyData(alertEmptyData){$scope.data.length||($scope.data=[],alertEmptyData.$promise.then(function(){alertEmptyData.show()}))}$scope.data=data.images,$scope.pagination=data.pagination,imageService.checkStatus($scope.data);var alertEmptyData=$alert({title:"Sin publicaciones",content:"No tiene ninguna publicación de tipo texto",placement:"top",type:"info",show:!1,container:"#box-alert"}),errorDelete=$alert({title:"Error al eliminar",content:"No se pudo eliminar la imagen",placement:"top",type:"danger",show:!1,container:"#box-alert-danger"});checkEmptyData(alertEmptyData);var myOtherModal=$modal({scope:$scope,template:"modal-previewImage.tpl",show:!1});$scope.modalDeleteImage=function(image_id){$scope.indexPreview=image_id,errorDelete.$promise.then(function(){errorDelete.hide()}),myOtherModal.$promise.then(myOtherModal.show)};$alert({title:"Publicación Eliminada",content:"Se ha eliminado correctamente la imagen",placement:"top",type:"success",show:!1,container:"#box-alert"});$scope.deleteImage=function(indexData){var url=Routing.generate("ds_facyt_infrastructure_user_image_delete"),data=angular.toJson({image_id:$scope.data[indexData].image_id});$.ajax({method:"POST",data:data,url:url,success:function(data){$scope.data.splice(indexData,1),myOtherModal.$promise.then(myOtherModal.hide),checkEmptyData()?alertEmptyData.$promise.then(function(){alertEmptyData.show()}):alertDeleteSuccess.$promise.then(function(){alertDeleteSuccess.show()})},error:function(){errorDelete.$promise.then(function(){errorDelete.show()})}})},$scope.getUrlEdit=function(image_id){$scope.urlEdit=Routing.generate("ds_facyt_infrastructure_user_image_edit",{imageId:image_id})}}]);