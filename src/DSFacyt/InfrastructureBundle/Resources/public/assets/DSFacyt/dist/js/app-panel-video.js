var video=angular.module("VideoModule",["angular-repeat-n","mgcrea.ngStrap"]).config(function($interpolateProvider){$interpolateProvider.startSymbol("{[{").endSymbol("}]}")}).config(["$httpProvider",function($httpProvider){$httpProvider.defaults.withCredentials="",$httpProvider.defaults.useXDomain=!1,$httpProvider.defaults.headers.common["X-Requested-With"]="XMLHttpRequest"}]).config(function($datepickerProvider){angular.extend($datepickerProvider.defaults,{dateFormat:"dd/MM/yyyy",startWeek:1})});video.filter("range",function(){return function(input,init,total){total=parseInt(total);for(var i=init;total>=i;i++)input.push(i);return input}}),video.service("videoService",function(){this.checkStatus=function(data){$.each(data,function(index,value){switch(value.status){case 0:value.classStatus="fa fa-circle";break;case 1:value.classStatus="fa fa-circle-o";break;case 2:value.classStatus="fa fa-circle-thin"}})},this.ajaxGetPublish=function(data,$scope){var url=Routing.generate("ds_facyt_infrastructure_get_publish_async");$.ajax({method:"POST",data:data,url:url,success:function(data){$scope.pagination=data.pagination,$scope.publish=data.publish,$scope.$apply()}})},this.setColorStatus=function(status_select){var response=0;switch(status_select){case 0:response="status-new";break;case"1":response="status-change";break;case"2":response="status-accepted";break;case"3":response="status-active";break;case"4":response="status-finish";break;case"5":response="status-canceled";break;default:response="status-new"}return response},this.setOrder=function(order){var response=null;return response=null==order?"ASC":"ASC"==order?"DESC":"ASC"}}),video.controller("VideoController",["$scope","$filter","videoService","$modal","$alert","$timeout",function($scope,$filter,videoService,$modal,$alert,$timeout){function checkEmptyData(alertEmptyData){return $scope.publish.length?!1:($scope.publish=[],!0)}$scope.publish=data.videos,$scope.pagination=data.pagination,$scope.selectedDate={date:new Date("2012-09-01")},$scope.indexEditVideo=null,$scope.filter=null,$scope.order=null,$scope.status=-1,$scope.alert_message=!1;var initializing=!1,alertEmptyData=$alert({title:"Sin publicaciones",content:"No tiene ninguna publicación de tipo videoo",placement:"top",type:"info",show:!1,container:"#box-alert"});checkEmptyData(alertEmptyData)&&alertEmptyData.$promise.then(function(){alertEmptyData.show()});var myOtherModal=$modal({scope:$scope,template:"modal-previewVideo.tpl",show:!1});$scope.modalPreviewVideo=function(video_id){$scope.indexPreview=video_id,myOtherModal.$promise.then(myOtherModal.show)};var alertDeleteSuccess=$alert({title:"Publicación Eliminada",content:"Se ha eliminado correctamente el videoo",placement:"top",type:"success",show:!1,container:"#box-alert"});$scope.deleteVideo=function(indexData){var url=Routing.generate("ds_facyt_infrastructure_user_video_delete"),data=angular.toJson({video_id:$scope.publish[indexData].id});$.ajax({method:"POST",data:data,url:url,success:function(data){$scope.publish.splice(indexData,1),myOtherModal.$promise.then(myOtherModal.hide),checkEmptyData()?alertEmptyData.$promise.then(function(){alertEmptyData.show()}):alertDeleteSuccess.$promise.then(function(){alertDeleteSuccess.show()})}})},$scope.generatePagination=function(pagination){$scope.urlPagination=Routing.generate("ds_facyt_infrastructure_user_video_homepage",{page:pagination})},$scope.getUrlEdit=function(video_id){$scope.urlEdit=Routing.generate("ds_facyt_infrastructure_user_video_edit",{videoId:video_id})},$scope.$watch("status_select",function(){if(initializing){$scope.alert_message=1,$scope.color_status=videoService.setColorStatus($scope.status_select);var status=$scope.status_select>=0?$scope.status_select:null,data=angular.toJson({status:status,type:"Video",page:0,filter:$scope.filter,order:$scope.order});videoService.ajaxGetPublish(data,$scope),$timeout(function(){$scope.alert_message=!1},1500)}}),$scope.setFiler=function(filter){$scope.alert_message=1,filter==$scope.filter?$scope.order=videoService.setOrder($scope.order):($scope.filter=filter,$scope.order="DESC");var data=angular.toJson({status:$scope.status_select,type:"Video",page:0,filter:$scope.filter,order:$scope.order});videoService.ajaxGetPublish(data,$scope),$timeout(function(){$scope.alert_message=!1},1500)},$scope.generatePagination=function(page){$scope.alert_message=1;var data=angular.toJson({status:$scope.status_select,type:"Video",page:page,filter:$scope.filter,order:$scope.order});videoService.ajaxGetPublish(data,$scope),$timeout(function(){$scope.alert_message=!1},1500)},$timeout(function(){initializing=!0,$scope.$apply()})}]);